name: Charge Amps - EV Charger Monitor
description: Monitor Charge Amps EV charger status and create Home Assistant entities
version: "1.3.4"
slug: charge_amps_ev_charger_monitor
init: false
homeassistant_api: true
hassio_role: homeassistant
arch:
  - aarch64
  - amd64
  - armhf
  - armv7
  - i386

# Options schema for UI-managed settings
options:
  email: ""
  password: ""
  host_name: "my.charge.space"
  base_url: "https://my.charge.space"
  update_interval: 1
  
  # Operation mode: standalone (internal price-based) or hems (external MQTT control)
  operation_mode: "standalone"
  
  # Standalone mode settings
  automation_enabled: true
  price_sensor_entity: "sensor.energy_prices_electricity_import_price"
  top_x_charge_count: 30
  price_threshold: 0.25
  max_current_per_phase: 12
  connector_ids: "1"
  
  # MQTT settings for Home Assistant Mosquitto broker
  # Get credentials from Mosquitto add-on configuration
  mqtt_host: "core-mosquitto"
  mqtt_port: 1883
  mqtt_user: ""
  mqtt_password: ""

schema:
  email: str
  password: str
  host_name: str
  base_url: str
  update_interval: int
  
  # Operation mode
  operation_mode: list(standalone|hems)?
  
  # Standalone mode settings
  automation_enabled: bool
  price_sensor_entity: str
  top_x_charge_count: int(1,96)
  price_threshold: "float?"
  max_current_per_phase: int(6,32)
  connector_ids: str
  
  # Advanced: MQTT settings (optional - auto-detects core-mosquitto by default)
  mqtt_host: str?
  mqtt_port: int?
  mqtt_user: str?
  mqtt_password: str?
