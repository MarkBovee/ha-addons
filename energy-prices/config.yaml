name: Energy Prices
description: Fetch Nord Pool electricity prices and calculate final costs with configurable price components
version: "1.6.0"
slug: energy_prices
init: false
homeassistant_api: true
arch:
  - aarch64
  - amd64
  - armhf
  - armv7
  - i386

# Options schema for UI-managed settings
options:
  delivery_area: "NL"
  currency: "EUR"
  timezone: "CET"
  fetch_interval_minutes: 60
  use_hourly_prices: false
  
  # Import price components (buying from grid)
  # Values in EUR/kWh (e.g., 0.0248 = 2.48 cents)
  import_vat_multiplier: 1.21
  import_markup: 0.02  # Zonneplan Inkoopvergoeding (incl BTW)
  import_energy_tax: 0.0790  # Energiebelasting 2026 (excl BTW)
  
  # Export price components (selling to grid / feed-in)
  # Zonneplan 2026 dynamic contract (with netting)
  # Values in EUR/kWh
  export_vat_multiplier: 1.21
  export_bonus_pct: 0.10  # Zonnebonus percentage (10%)
  export_fixed_bonus: 0.02  # Zonnebonus fixed (2 cents)
  export_energy_tax: 0.0790  # Energiebelasting 2026 (excl BTW)
  
  # Location for daylight calculation (Zonneplan solar bonus)
  # Default: Utrecht, NL
  latitude: 52.0907
  longitude: 5.1214
  
  # MQTT settings for Home Assistant Mosquitto broker
  # Get credentials from Mosquitto add-on configuration
  mqtt_host: "core-mosquitto"
  mqtt_port: 1883
  mqtt_user: ""
  mqtt_password: ""

# Schema defines the data types for validation
schema:
  delivery_area: str
  currency: str
  timezone: str
  fetch_interval_minutes: int
  use_hourly_prices: bool?
  # Import price components
  import_vat_multiplier: float
  import_markup: float
  import_energy_tax: float
  # Export price components
  export_vat_multiplier: float
  export_fixed_bonus: float
  export_bonus_pct: float
  export_energy_tax: float
  # Location for daylight calculation
  latitude: float
  longitude: float
  # Advanced: MQTT settings (optional - auto-detects core-mosquitto by default)
  mqtt_host: str?
  mqtt_port: int?
  mqtt_user: str?
  mqtt_password: str?